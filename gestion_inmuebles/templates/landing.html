{% extends 'base.html' %}
{% load static %}

{% block title %}G3 Propiedades - Tu plataforma inmobiliaria de confianza{% endblock %}

{% block extra_css %}
<style>
    /* Hero Section */
    .hero-section {
        background: linear-gradient(rgba(28, 61, 91, 0.85), rgba(28, 61, 91, 0.85)),
                    url('{% static "images/hero-bg.jpg" %}');
        background-size: cover;
        background-position: center;
        min-height: 80vh;
        display: flex;
        align-items: center;
        color: white;
        position: relative;
    }

    .search-form {
        background: white;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        margin-top: 2rem;
    }

    /* Property Carousel */
    .property-slide {
        padding: 1rem;
    }

    /* Services Section */
    .services-section {
        background: var(--primary-color);
        color: white;
        padding: 5rem 0;
    }

    .service-card {
        background: rgba(255,255,255,0.1);
        border-radius: 12px;
        padding: 2rem;
        height: 100%;
        transition: all 0.3s ease;
    }

    .service-card:hover {
        background: rgba(255,255,255,0.2);
        transform: translateY(-5px);
    }

    /* Regions Section */
    .region-card {
        position: relative;
        height: 300px;
        border-radius: 12px;
        overflow: hidden;
    }

    .region-card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .region-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
        display: flex;
        align-items: flex-end;
        padding: 2rem;
        color: white;
    }

    /* Contact Section */
    .contact-section {
        background: var(--light-bg);
    }

    .faq-item {
        border: none;
        background: transparent;
    }

    .faq-button {
        padding: 1rem;
        font-weight: 500;
        font-size: 1.2rem;
        color: var(--primary-color);
        background: white;
        border-radius: 8px;
        width: 100%;
        text-align: left;
        border: none;
        transition: all 0.3s ease;
    }

    .faq-button:not(.collapsed) {
        background: var(--primary-color);
        color: white;
    }

    .stats-card {
        background: white;
        border-radius: 12px;
        padding: 2rem;
        text-align: center;
        height: 100%;
    }

    .stats-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--secondary-color);
        margin-bottom: 0.5rem;
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold mb-4">Encuentra tu hogar ideal en Chile</h1>
                <p class="lead mb-4">Explora nuestra selección de propiedades en arriendo y venta en las mejores ubicaciones.</p>
                <div class="search-form">
                    <form action="{% url 'search_properties' %}" method="get">
                        <div class="row g-3">
                            <div class="col-12">
                                <select class="form-select" name="tipo_operacion" id="tipo_operacion">
                                    <option value="">Tipo de Operación</option>
                                    <option value="venta">Venta</option>
                                    <option value="arriendo">Arriendo</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <select class="form-select" name="region" id="region">
                                    <option value="">Región</option>
                                    {% for region in regiones %}
                                        <option value="{{ region.id }}">{{ region.nombre_region }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-6">
                                <select class="form-select" name="tipo_propiedad" id="tipo_propiedad">
                                    <option value="">Tipo de Propiedad</option>
                                    {% for tipo in tipos_inmueble %}
                                        <option value="{{ tipo.id }}">{{ tipo.tipo }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary w-100">Buscar Propiedades</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Rest of the content... -->

{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const regionSelect = document.getElementById('region');
        const tipoSelect = document.getElementById('tipo_propiedad');

        regionSelect.addEventListener('change', function() {
            const regionId = this.value;
            if (regionId) {
                fetch(`/api/comunas/?region=${regionId}`)
                    .then(response => response.json())
                    .then(data => {
                        const comunaSelect = document.getElementById('comuna');
                        comunaSelect.innerHTML = '<option value="">Seleccione una comuna</option>';
                        data.forEach(comuna => {
                            const option = document.createElement('option');
                            option.value = comuna.id;
                            option.textContent = comuna.nombre;
                            comunaSelect.appendChild(option);
                        });
                        comunaSelect.disabled = false;
                    })
                    .catch(error => console.error('Error:', error));
            }
        });
    });
</script>
{% endblock %}